<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Excellence Tutorial Computer-Based Testing System</title>
  <!-- Standard favicon -->
<link rel="icon" href="IMG_4512.png" type="image/png">

<!-- For Apple devices -->
<link rel="apple-touch-icon" href="IMG_4512.png">

<!-- Optional: specify size for different devices -->
<link rel="icon" type="image/png" sizes="32x32" href="IMG_4512.png">
<link rel="icon" type="image/png" sizes="16x16" href="IMG_4512.png">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
  /* Main background with subtle animation */
  body {
    margin: 0; padding: 0; min-height: 100vh;
    background: linear-gradient(-45deg, #1e1b4b, #2e1065, #4c1d95, #6b21b6);
    background-size: 400% 400%;
    animation: gradient 15s ease infinite;
    font-family: 'Segoe UI', system-ui, sans-serif;
    color: white;
  }
  @keyframes gradient { 0%{background-position:0% 50%} 50%{background-position:100% 50%} 100%{background-position:0% 50%} }

  /* Premium glassmorphism card */
  .glass {
    background: rgba(255, 255, 255, 0.12);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    border: 1px solid rgba(255, 255, 255, 0.25);
    border-radius: 2rem;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
  }

  /* Dark glass for questions & results */
  .glass-dark {
    background: rgba(0, 0, 0, 0.35);
    backdrop-filter: blur(12px);
    border-radius: 1.5rem;
    border: 1px solid rgba(255, 255, 255, 0.1);
  }

  /* Beautiful buttons */
  .btn {
    @apply bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 
           text-white font-bold py-5 px-10 rounded-2xl transition-all duration-300 
           transform hover:scale-105 shadow-xl text-lg;
  }

  /* Grade badges — make them pop! */
  .grade-A { @apply bg-green-500 shadow-green-500/50; }
  .grade-B { @apply bg-blue-500 shadow-blue-500/50; }
  .grade-C { @apply bg-yellow-500 shadow-yellow-500/50; }
  .grade-D { @apply bg-orange-500 shadow-orange-500/50; }
  .grade-F { @apply bg-red-500 shadow-red-500/50; }

  /* Timer glow when low */
  #timer.low { @apply text-red-400 animate-pulse text-5xl font-bold; }

  /* Input fields — premium look */
  input[type="text"], input[type="password"] {
    @apply w-full p-5 rounded-2xl bg-white/15 border border-white/30 
           text-white placeholder-gray-300 focus:outline-none focus:ring-4 
           focus:ring-purple-500/50 backdrop-blur transition;
  }

  /* Radio buttons — bigger and beautiful */
  input[type="radio"] {
    @apply w-6 h-6 accent-purple-500 transform scale-125;
  }

  /* Hover effect on options */
  label:hover {
    @apply bg-white/10 transform scale-102 transition;
  }

  /* Scrollbar styling (optional beauty touch) */
  ::-webkit-scrollbar { width: 10px; }
  ::-webkit-scrollbar-track { @apply bg-transparent; }
  ::-webkit-scrollbar-thumb { @apply bg-white/30 rounded-full; }
  ::-webkit-scrollbar-thumb:hover { @apply bg-white/50; }
</style>
</head>
<body class="text-white">
  <div id="app" class="min-h-screen p-6"></div>

  <script>
    // ALL DATA SAVED IN BROWSER — WORKS ON GITHUB PAGES!
    let students = JSON.parse(localStorage.getItem('excellence_students') || '{}');
    let attempts = JSON.parse(localStorage.getItem('excellence_attempts') || '[]');

    // CREDENTIALS
    const credentials = {
      "Shiloh": "Olusegun",
      "Sophiat": "Busari",
      "Maria": "Gbadamosi",
      "Muhammed": "Jimoh",
      "Teacher": "Master"
    };

    let user = null;
    let exam = null;

    // FULL 320+ QUESTIONS (40 per subject)
    const questions = {
    jss1: {
    'English Language': [
      {
        q: "Passage: 'The critic praised the novel's intricate plot but noted that its characters remained curiously flat and unmemorable.' What can be reliably inferred?",
        opts: ["The novel's plot was overly complicated.", "The critic found the characters underdeveloped despite the strong plot.", "The characters were intentionally simplistic.", "The novel lacked any plot structure."],
        ans: 1,
        exp: "The use of 'but' signals contrast: praise for plot complexity contrasted with criticism of shallow characters."
      },
      {
        q: "From the statement: 'Unlike his predecessors, the new leader avoided public confrontations, preferring quiet diplomacy.' What is implied about the predecessors?",
        opts: ["They were known for avoiding conflicts.", "They favored open and direct confrontations.", "They achieved more diplomatic success.", "They were more reserved in public."],
        ans: 1,
        exp: "'Unlike' establishes contrast; the new leader's avoidance implies predecessors engaged in public confrontations."
      },
      {
        q: "Which word is the most precise synonym for 'perspicacious'?",
        opts: ["Confused", "Shrewd", "Obtuse", "Indifferent"],
        ans: 1,
        exp: "'Perspicacious' means having keen understanding and insight; 'shrewd' is the closest synonym."
      },
      {
        q: "Select the best antonym for 'ebullient'.",
        opts: ["Enthusiastic", "Subdued", "Exuberant", "Joyful"],
        ans: 1,
        exp: "'Ebullient' means overflowing with enthusiasm; its opposite is 'subdued' or restrained."
      },
      {
        q: "Which pair are true homophones?",
        opts: ["Accept / Except", "Principal / Principle", "Cite / Sight / Site", "Bear / Bare"],
        ans: 2,
        exp: "'Cite', 'sight', and 'site' are homophones; the others are pairs, not triples."
      },
      {
        q: "Identify the correct pair of homonyms.",
        opts: ["Lead (metal) / Led", "Rain / Reign / Rein", "Break / Brake", "Right / Write"],
        ans: 1,
        exp: "'Rain', 'reign', and 'rein' are homophones with different meanings and spellings."
      },
      {
        q: "By the time we reach the summit tomorrow, we _____ for eight hours straight.",
        opts: ["will climb", "will have been climbing", "will be climbing", "are climbing"],
        ans: 1,
        exp: "Future perfect continuous emphasizes duration of an ongoing action up to a future point."
      },
      {
        q: "While the orchestra _____ the symphony, the conductor suddenly collapsed.",
        opts: ["played", "was playing", "had played", "has been playing"],
        ans: 1,
        exp: "Past continuous for a longer action interrupted by a shorter simple past action."
      },
      {
        q: "At 10 p.m. tomorrow, I _____ on this project for three full days.",
        opts: ["will work", "will be working", "will have been working", "am working"],
        ans: 2,
        exp: "Future perfect continuous for duration continuing up to a specific future time."
      },
      {
        q: "When I phoned her yesterday, she _____ still _____ dinner for the guests.",
        opts: ["had ... prepared", "was ... preparing", "has ... prepared", "is ... preparing"],
        ans: 1,
        exp: "Past continuous for an ongoing action at a specific past moment."
      },
      {
        q: "The criterion for selection _____ stringent, but the committee _____ flexible in exceptional cases.",
        opts: ["is / are", "are / is", "is / was", "are / were"],
        ans: 0,
        exp: "'Criterion' is singular; 'committee' can take plural verb when acting individually."
      },
      {
        q: "Neither the coach nor the players _____ willing to accept responsibility for the defeat.",
        opts: ["was", "were", "is", "has been"],
        ans: 1,
        exp: "In 'neither...nor', verb agrees with nearer subject ('players' plural → 'were')."
      },
      {
        q: "A series of workshops _____ been scheduled, yet the main speaker _____ not confirmed.",
        opts: ["has / has", "have / has", "has / have", "have / have"],
        ans: 1,
        exp: "'Series' is singular; 'speaker' is singular."
      },
      {
        q: "The majority of the evidence _____ overwhelming, though one key document _____ missing.",
        opts: ["is / is", "are / is", "is / are", "are / are"],
        ans: 0,
        exp: "'Majority of evidence' treated as collective (singular); 'document' singular."
      },
      {
        q: "Correct punctuation: 'The professor asked Have you completed the assignment'",
        opts: ["asked Have you...", "asked, 'Have you...'", "asked: 'Have you...'", "asked \"Have you...\""],
        ans: 2,
        exp: "Colon introduces a direct question quotation after a reporting clause."
      },
      {
        q: "Which sentence is correctly punctuated?",
        opts: ["Its a beautiful day isn't it?", "It's a beautiful day, isn't it?", "Its a beautiful day, isn't it?", "It's a beautiful day isn't it?"],
        ans: 1,
        exp: "Contraction 'It's' + comma before tag question."
      },
      {
        q: "Identify the compound-complex sentence.",
        opts: ["She ran to the store and bought milk.", "Although it was late, he finished the report, and he submitted it early.", "Because the rain stopped, we went outside.", "Smiling broadly, she accepted the award."],
        ans: 1,
        exp: "One dependent clause + two independent clauses joined by 'and'."
      },
      {
        q: "Which is a complex sentence?",
        opts: ["The team celebrated, and the fans cheered loudly.", "When the bell rang, the students left the classroom.", "The book was interesting but long.", "Run quickly!"],
        ans: 1,
        exp: "Contains one independent and one dependent clause introduced by 'when'."
      },
      {
        q: "In advanced narrative writing, the most effective way to reveal character is through:",
        opts: ["Direct authorial statements about personality.", "Actions, dialogue, and internal thoughts rather than explicit description.", "Lengthy physical descriptions.", "Summary of past events."],
        ans: 1,
        exp: "'Show, don't tell' principle: indirect revelation creates depth and authenticity."
      },
      {
        q: "A sophisticated narrative technique for creating unreliable narration involves:",
        opts: ["Consistent third-person omniscient viewpoint.", "Subtle discrepancies between what the narrator claims and evidence in the text.", "Frequent authorial interventions.", "Strict chronological order."],
        ans: 1,
        exp: "Unreliable narrators are crafted through gaps and contradictions that readers detect."
      },
      {
        q: "Advanced descriptive writing avoids clichés by employing:",
        opts: ["Stock phrases like 'crystal clear'.", "Original metaphors and precise sensory details beyond visual.", "Heavy reliance on adverbs.", "Generic adjectives like 'beautiful' or 'nice'."],
        ans: 1,
        exp: "Fresh, specific, multi-sensory imagery elevates description."
      },
      {
        q: "The hallmark of masterful descriptive prose is:",
        opts: ["Objective reporting of facts.", "Subjective selection of details that imply mood or theme.", "Exhaustive listing of every observable feature.", "Minimal use of figurative language."],
        ans: 1,
        exp: "Selective detail implies more than it states, engaging reader imagination."
      },
      {
        q: "In a formal letter to a known recipient, the correct salutation and closing pair is:",
        opts: ["Dear Sir / Yours faithfully", "Dear Mr. Johnson / Yours sincerely", "Hi John / Best wishes", "To whom it may concern / Regards"],
        ans: 1,
        exp: "When name known: 'Dear Mr./Ms. [Surname]' + 'Yours sincerely' (British) or 'Sincerely' (American)."
      },
      {
        q: "A feature of highly formal letters is:",
        opts: ["Use of contractions and exclamations.", "Complex sentences, passive voice, and formal vocabulary without slang.", "Emojis and abbreviations.", "First-name salutations."],
        ans: 1,
        exp: "Formal register avoids contractions, phrasal verbs, and colloquialisms."
      },
      {
        q: "Informal letters at an advanced level effectively use:",
        opts: ["Rigid structure and formulaic phrases.", "Varied sentence length, idioms, contractions, and personal anecdotes.", "No paragraphs or greetings.", "Subject lines only."],
        ans: 1,
        exp: "Natural conversational flow with expressive language distinguishes good informal writing."
      },
      {
        q: "Which is characteristic of informal correspondence?",
        opts: ["Avoidance of all personal pronouns.", "Inclusion of rhetorical questions and direct address (you).", "Mandatory postscript section.", "Block format only."],
        ans: 1,
        exp: "Informal tone engages reader directly with 'you' and questions."
      },
      {
        q: "In persuasive speeches, the rhetorical device 'anaphora' is most powerful when:",
        opts: ["Used sparingly at key emotional peaks.", "Repeated excessively throughout.", "Combined with unrelated imagery.", "Placed only in the conclusion."],
        ans: 0,
        exp: "Strategic repetition at beginnings of clauses builds rhythm and emphasis."
      },
      {
        q: "Advanced speech writing employs 'antithesis' to:",
        opts: ["Create humorous exaggeration.", "Highlight contrasts through balanced opposing phrases.", "List statistics sequentially.", "Describe scenery vividly."],
        ans: 1,
        exp: "Parallel structure with opposition sharpens ideas and memorability."
      },
      {
        q: "Sophisticated dramatic dialogue is distinguished by:",
        opts: ["On-the-nose statements explaining feelings.", "Subtext and implication where meaning lies between lines.", "Perfect grammar regardless of character.", "Long monologues."],
        ans: 1,
        exp: "Great dialogue conveys more through what is unsaid or indirect."
      },
      {
        q: "Realistic dialogue differs from natural speech because it:",
        opts: ["Includes more fillers and repetitions.", "Is purposeful, concise, and advances character or plot.", "Avoids contractions entirely.", "Uses formal vocabulary."],
        ans: 1,
        exp: "Written dialogue is edited for impact, removing redundancy of real talk."
      },
      {
        q: "In précis writing, the most important principle is:",
        opts: ["Retaining original sentence structure.", "Maintaining proportional emphasis and logical sequence while condensing.", "Adding interpretive commentary.", "Quoting extensively."],
        ans: 1,
        exp: "Précis preserves structure, balance, and intent in one-third length."
      },
      {
        q: "Advanced summary technique requires:",
        opts: ["Changing the original thesis slightly.", "Objectivity: eliminating personal opinion and evaluative language.", "Expanding minor points.", "Reordering for clarity."],
        ans: 1,
        exp: "Summaries remain neutral, faithful to author's intent."
      },
      {
        q: "When summarizing argumentative text, one must:",
        opts: ["Weaken opposing views.", "Represent all sides fairly in proportion to the original.", "Omit counterarguments.", "Add supporting evidence."],
        ans: 1,
        exp: "Fair representation preserves original balance."
      },
      {
        q: "A key skill in summary writing is:",
        opts: ["Generalizing specific examples without losing core meaning.", "Retaining all illustrative details.", "Using mostly direct quotation.", "Introducing new transitions."],
        ans: 0,
        exp: "Abstraction maintains brevity while preserving essence."
      },
      {
        q: "Passage: 'The reforms were introduced with great fanfare, yet within months public enthusiasm had waned.' What can be inferred?",
        opts: ["The reforms were poorly implemented.", "Initial support was superficial or short-lived.", "The public opposed the reforms from the start.", "Enthusiasm grew over time."],
        ans: 1,
        exp: "Contrast between 'great fanfare' and rapid waning implies fleeting excitement."
      },
      {
        q: "Which is the most precise antonym for 'insouciant'?",
        opts: ["Carefree", "Anxious", "Indifferent", "Relaxed"],
        ans: 1,
        exp: "'Insouciant' means casually unconcerned; opposite is worried or anxious."
      },
      {
        q: "By next July, the researchers _____ the data for over five years.",
        opts: ["will analyze", "will have been analyzing", "will be analyzing", "are analyzing"],
        ans: 1,
        exp: "Future perfect continuous for prolonged action up to future point."
      },
      {
        q: "Either the witnesses or the defendant _____ lying about the events.",
        opts: ["is", "are", "were", "have"],
        ans: 0,
        exp: "Verb agrees with nearer subject 'defendant' (singular)."
      },
      {
        q: "In narrative essays, foreshadowing is most effective when:",
        opts: ["Stated directly and obviously.", "Subtle and integrated naturally into description.", "Used only at chapter ends.", "Avoided entirely."],
        ans: 1,
        exp: "Subtle hints build suspense without spoiling."
      },
      {
        q: "In formal complaint letters, tone should be:",
        opts: ["Aggressive and emotional.", "Assertive, factual, and polite.", "Sarcastic and indirect.", "Casual and friendly."],
        ans: 1,
        exp: "Professional complaints maintain courtesy while stating issues clearly."
      }
    ],
    'Mathematics': [
      {
        q: "If \\frac{5}{12} of a number is subtracted from \\frac{7}{8} of the same number, the result is 16. Find the number.",
        opts: ["48", "72", "96", "120"],
        ans: 2,
        exp: "Let x be the number. \\frac{7}{8}x - \\frac{5}{12}x = 16. LCM 24: \\frac{21x - 10x}{24} = 16 \\to 11x = 384 \\to x = 96."
      },
      {
        q: "Compute 3.6 × 0.04 ÷ 0.12 without calculator.",
        opts: ["1.2", "1.5", "1.8", "2.0"],
        ans: 0,
        exp: "3.6 ÷ 0.12 = 30, then 30 × 0.04 = 1.2."
      },
      {
        q: "Express 0.8\\overline{3} as a fraction in lowest terms.",
        opts: ["\\frac{5}{6}", "\\frac{3}{4}", "\\frac{83}{99}", "\\frac{75}{90}"],
        ans: 0,
        exp: "Let x = 0.8333..., 10x = 8.333..., 100x = 83.333... \\to 90x = 75 \\to x = \\frac{5}{6}."
      },
      {
        q: "0.12\\overline{45} = ?",
        opts: ["\\frac{1245}{9900}", "\\frac{112}{891}", "\\frac{415}{3333}", "\\frac{124}{990}"],
        ans: 3,
        exp: "Let x = 0.124545... , 100x = 12.4545..., 10000x = 1245.4545... \\to 9900x = 1233 \\to x = \\frac{124}{990} (simplified)."
      },
      {
        q: "If a : b = 3 : 4 and b : c = 5 : 7, find a : b : c.",
        opts: ["15:20:28", "15:20:35", "3:4:7", "9:12:35"],
        ans: 0,
        exp: "Make b common: a:b = 15:20, b:c = 20:28 \\to a:b:c = 15:20:28."
      },
      {
        q: "A mixture contains milk and water in the ratio 5:2. How much water must be added to 49 litres of mixture to make the ratio 5:3?",
        opts: ["7 litres", "8 litres", "9 litres", "10 litres"],
        ans: 0,
        exp: "Milk = 35 L, water = 14 L. Let x L water added. 35 / (14 + x) = 5/3 \\to 105 = 70 + 5x \\to 5x = 35 \\to x = 7."
      },
      {
        q: "If 25% of (x + 40) = 40% of (x - 20), find x.",
        opts: ["100", "120", "140", "160"],
        ans: 1,
        exp: "0.25(x + 40) = 0.4(x - 20) \\to x + 40 = 1.6(x - 20) \\to x + 40 = 1.6x - 32 \\to 72 = 0.6x \\to x = 120."
      },
      {
        q: "The price of an item is increased by 30% and then decreased by 30%. What is the net percentage change?",
        opts: ["9% increase", "9% decrease", "0%", "No change"],
        ans: 1,
        exp: "Net change = -9% (100 \\to 130 \\to 91)."
      },
      {
        q: "A sum of $5000 at 8% simple interest amounts to $6800 in how many years?",
        opts: ["4", "4.5", "5", "5.5"],
        ans: 1,
        exp: "Interest = 1800. Time = 1800 × 100 / (5000 × 8) = 4.5 years."
      },
      {
        q: "Find the principal if simple interest at 12% for 3 years is $1080.",
        opts: ["$2800", "$3000", "$3200", "$3400"],
        ans: 1,
        exp: "P × 12 × 3 / 100 = 1080 \\to P = 3000."
      },
      {
        q: "Solve: 5x - 8 = 3(x + 4)",
        opts: ["10", "11", "12", "13"],
        ans: 0,
        exp: "5x - 8 = 3x + 12 \\to 2x = 20 \\to x = 10."
      },
      {
        q: "The perimeter of a rectangle is 62 cm and length is 5 cm more than width. Find the length.",
        opts: ["18 cm", "19 cm", "20 cm", "21 cm"],
        ans: 0,
        exp: "Let width = x, length = x+5. 2(x + x+5) = 62 \\to 4x + 10 = 62 \\to 4x = 52 \\to x = 13, length = 18."
      },
      {
        q: "In a triangle, angles are in ratio 2:3:4. Find the largest angle.",
        opts: ["60°", "80°", "100°", "120°"],
        ans: 1,
        exp: "Sum = 180°, 9 parts \\to 1 part = 20°, largest = 80°."
      },
      {
        q: "The exterior angle of a regular polygon is 40°. How many sides does it have?",
        opts: ["8", "9", "10", "12"],
        ans: 1,
        exp: "360° / 40° = 9 sides."
      },
      {
        q: "In triangle ABC, angle B = 90°, AB = 8 cm, BC = 15 cm. Find AC.",
        opts: ["17 cm", "18 cm", "19 cm", "20 cm"],
        ans: 0,
        exp: "Hypotenuse AC = \\sqrt{8^2 + 15^2} = \\sqrt{289} = 17 cm."
      },
      {
        q: "The diagonals of a rhombus are 24 cm and 10 cm. Find the side length.",
        opts: ["13 cm", "14 cm", "15 cm", "16 cm"],
        ans: 0,
        exp: "Half diagonals 12 and 5 \\to side = \\sqrt{12^2 + 5^2} = \\sqrt{169} = 13 cm."
      },
      {
        q: "Find the area of a trapezium with parallel sides 12 cm and 20 cm, height 8 cm.",
        opts: ["128 cm²", "136 cm²", "144 cm²", "160 cm²"],
        ans: 0,
        exp: "Area = \\frac{1}{2} × (12 + 20) × 8 = 128 cm²."
      },
      {
        q: "A circle has circumference 44 cm. Find its area.",
        opts: ["154 cm²", "176 cm²", "196 cm²", "224 cm²"],
        ans: 0,
        exp: "2πr = 44 \\to r = 7 \\to area = π × 49 = 154 cm²."
      },
      {
        q: "The mean of 8 numbers is 15. If one number is removed, the mean becomes 14. What number was removed?",
        opts: ["20", "22", "24", "26"],
        ans: 1,
        exp: "Total = 8×15 = 120. New total = 7×14 = 98. Removed = 22."
      },
      {
        q: "The mode of the data 5, 8, 7, 5, 9, 5, 10, 8, 5 is",
        opts: ["5", "8", "7", "10"],
        ans: 0,
        exp: "5 appears 4 times, most frequent."
      },
      {
        q: "In a bar graph, heights are 20, 30, 25, 40, 35 units. What is the range?",
        opts: ["15", "20", "25", "30"],
        ans: 1,
        exp: "Highest 40, lowest 20 \\to range = 20."
      },
      {
        q: "The probability of getting a head when two fair coins are tossed is",
        opts: ["\\frac{1}{4}", "\\frac{1}{2}", "\\frac{3}{4}", "1"],
        ans: 1,
        exp: "Outcomes: HH, HT, TH, TT. At least one head: 3/4."
      },
      {
        q: "A bag contains 5 red and 7 blue balls. Probability of drawing 2 red balls without replacement is",
        opts: ["\\frac{5}{33}", "\\frac{10}{33}", "\\frac{15}{66}", "\\frac{7}{33}"],
        ans: 1,
        exp: "\\frac{5}{12} × \\frac{4}{11} = \\frac{20}{132} = \\frac{10}{66} = \\frac{5}{33} (wait, actually \\frac{10}{66}). Corrected to \\frac{10}{66} simplified."
      },
      {
        q: "The probability that a leap year has 53 Sundays is",
        opts: ["\\frac{1}{7}", "\\frac{2}{7}", "\\frac{3}{7}", "\\frac{1}{4}"],
        ans: 1,
        exp: "Leap year 366 days = 52 weeks + 2 days \\to 2 chances for Sunday \\to 2/7."
      },
      {
        q: "If P(E) = 0.35, P(F) = 0.45, and P(E ∩ F) = 0.1, find P(E ∪ F).",
        opts: ["0.7", "0.8", "0.9", "0.6"],
        ans: 0,
        exp: "0.35 + 0.45 - 0.1 = 0.7."
      },
      {
        q: "A die is rolled. Probability of getting a prime number is",
        opts: ["\\frac{1}{2}", "\\frac{2}{3}", "\\frac{1}{3}", "\\frac{5}{6}"],
        ans: 0,
        exp: "Primes: 2,3,5 \\to 3/6 = 1/2."
      },
      {
        q: "In △ABC, angle A = 50°, angle B = 70°. Find angle C.",
        opts: ["50°", "60°", "70°", "80°"],
        ans: 1,
        exp: "180 - 50 - 70 = 60°."
      },
      {
        q: "Find the area of an equilateral triangle with side 10 cm.",
        opts: ["25\\sqrt{3} cm²", "50\\sqrt{3} cm²", "25 cm²", "50 cm²"],
        ans: 0,
        exp: "\\frac{\\sqrt{3}}{4} × 100 = 25\\sqrt{3}."
      },
      {
        q: "The sum of ages of A and B is 40 years. 5 years ago, A was twice as old as B. Find A's present age.",
        opts: ["25 years", "26 years", "27 years", "28 years"],
        ans: 0,
        exp: "Let B = x, A = 40 - x. 40 - x - 5 = 2(x - 5) \\to 35 - x = 2x - 10 \\to 45 = 3x \\to x = 15, A = 25."
      },
      {
        q: "If 3x + 5 = 2(x + 9), find x.",
        opts: ["13", "14", "15", "16"],
        ans: 0,
        exp: "3x + 5 = 2x + 18 \\to x = 13."
      },
      {
        q: "A shopkeeper marks an item 40% above cost price and offers 15% discount. If CP = $500, find SP.",
        opts: ["$550", "$575", "$595", "$600"],
        ans: 2,
        exp: "MP = 500 × 1.4 = 700. SP = 700 × 0.85 = 595."
      },
      {
        q: "Find the perimeter of a square whose area is 144 cm².",
        opts: ["36 cm", "48 cm", "56 cm", "64 cm"],
        ans: 1,
        exp: "Side = 12 cm \\to perimeter = 48 cm."
      },
      {
        q: "In a class of 40 students, 25 like Maths, 18 like English, and 8 like both. How many like neither?",
        opts: ["5", "6", "7", "8"],
        ans: 0,
        exp: "Like at least one = 25 + 18 - 8 = 35. Neither = 40 - 35 = 5."
      },
      {
        q: "The median of the data 12, 15, 18, 20, 22, 25, 30 is",
        opts: ["18", "20", "22", "25"],
        ans: 1,
        exp: "Middle value (4th) = 20."
      },
      {
        q: "A card is drawn from a standard deck. Probability it is a king or a heart is",
        opts: ["\\frac{4}{13}", "\\frac{17}{52}", "\\frac{16}{52}", "\\frac{1}{4}"],
        ans: 2,
        exp: "Kings = 4, hearts = 13, king of hearts overlap 1 \\to 4 + 13 - 1 = 16/52."
      },
      {
        q: "If \\frac{2}{3} of a number is 24 less than the number, find the number.",
        opts: ["72", "80", "90", "96"],
        ans: 0,
        exp: "x - \\frac{2}{3}x = 24 \\to \\frac{1}{3}x = 24 \\to x = 72."
      },
      {
        q: "Two numbers are in the ratio 5:8. If their difference is 18, find the larger number.",
        opts: ["24", "30", "40", "48"],
        ans: 3,
        exp: "Difference 3 parts = 18 \\to 1 part = 6 \\to larger = 48."
      },
      {
        q: "The area of a triangle with base 15 cm and height 8 cm is",
        opts: ["60 cm²", "120 cm²", "80 cm²", "100 cm²"],
        ans: 0,
        exp: "\\frac{1}{2} × 15 × 8 = 60 cm²."
      }
    ],
    'Basic Science': [
      {
        q: "When a solid is heated, its particles gain kinetic energy and vibrate more vigorously. At the melting point, the substance changes to liquid because:",
        opts: ["The particles lose mass.", "The intermolecular forces are completely broken.", "The particles overcome the forces holding them in fixed positions.", "The volume increases suddenly."],
        ans: 2,
        exp: "Melting occurs when particles gain enough energy to break free from fixed lattice positions while intermolecular forces still exist."
      },
      {
        q: "Sublimation is the direct change from solid to gas. Which substance commonly exhibits sublimation at normal atmospheric pressure?",
        opts: ["Water", "Carbon dioxide (dry ice)", "Sodium chloride", "Alcohol"],
        ans: 1,
        exp: "Dry ice (solid CO₂) sublimes without melting."
      },
      {
        q: "During evaporation, the temperature of the remaining liquid:",
        opts: ["Increases", "Decreases", "Remains constant", "First increases then decreases"],
        ans: 1,
        exp: "Faster-moving molecules escape, leaving slower ones behind, reducing average kinetic energy."
      },
      {
        q: "Boiling differs from evaporation mainly because boiling:",
        opts: ["Occurs only at the surface.", "Happens at any temperature.", "Takes place throughout the liquid at a specific temperature.", "Does not require heat."],
        ans: 2,
        exp: "Boiling involves bubble formation throughout the liquid at boiling point."
      },
      {
        q: "A mixture of iron filings and sulphur powder can be best separated by:",
        opts: ["Filtration", "Dissolving in water then filtration", "Using a magnet", "Evaporation"],
        ans: 2,
        exp: "Iron is magnetic, so a magnet attracts iron filings."
      },
      {
        q: "To separate a mixture of sand and salt, the most efficient sequence is:",
        opts: ["Dissolve in water → filter → evaporate filtrate", "Filter → evaporate → dissolve residue", "Evaporate → filter → dissolve", "Magnet → filter → evaporate"],
        ans: 0,
        exp: "Salt dissolves, sand does not; filtration separates sand, evaporation recovers salt."
      },
      {
        q: "Chromatography is most suitable for separating:",
        opts: ["Immiscible liquids", "Components of ink (dyes)", "Salt from seawater", "Oil from water"],
        ans: 1,
        exp: "Different dyes have different affinities for solvent and paper."
      },
      {
        q: "Distillation is used to separate liquids that:",
        opts: ["Have different boiling points", "Have the same density", "Are coloured differently", "React chemically"],
        ans: 0,
        exp: "Lower boiling point component vaporises first."
      },
      {
        q: "Which is an example of chemical energy being converted to electrical energy?",
        opts: ["Rubbing a balloon", "Dry cell (battery)", "Solar panel", "Wind turbine"],
        ans: 1,
        exp: "Chemical reactions in a battery produce electrical current."
      },
      {
        q: "In a hydroelectric power station, the main energy transformation is:",
        opts: ["Chemical → electrical", "Potential → kinetic → electrical", "Nuclear → thermal → electrical", "Light → electrical"],
        ans: 1,
        exp: "Gravitational potential → kinetic → mechanical → electrical."
      },
      {
        q: "When a bulb glows, electrical energy is transformed into:",
        opts: ["Light energy only", "Heat energy only", "Light and heat energy", "Sound energy"],
        ans: 2,
        exp: "Filament produces both light and heat."
      },
      {
        q: "In an experiment, a metal spoon in hot tea becomes hot. This is mainly due to:",
        opts: ["Conduction", "Convection", "Radiation", "Evaporation"],
        ans: 0,
        exp: "Heat transfers through solid metal by conduction."
      },
      {
        q: "Sea breezes occur because:",
        opts: ["Land heats up faster than sea during the day", "Sea heats up faster than land", "Air pressure is always higher over sea", "Water evaporates faster"],
        ans: 0,
        exp: "Land heats faster → warm air rises → cooler sea air moves in."
      },
      {
        q: "A black surface is a better absorber and emitter of heat radiation than a white surface. This explains why:",
        opts: ["Dark clothes feel hotter in sunlight", "Snow melts slower under white cover", "Radiators are painted silver", "Mirrors reflect heat"],
        ans: 0,
        exp: "Black absorbs more radiation."
      },
      {
        q: "When a convex lens is used to focus sunlight on paper, the paper burns because:",
        opts: ["Light rays converge to a point, concentrating energy", "Lens absorbs heat", "Paper changes colour", "Air ignites"],
        ans: 0,
        exp: "Parallel rays converge at focal point, increasing intensity."
      },
      {
        q: "A plane mirror forms an image that is:",
        opts: ["Real, inverted, same size", "Virtual, erect, same size", "Real, erect, magnified", "Virtual, inverted, diminished"],
        ans: 1,
        exp: "Plane mirror images are virtual, erect, same size."
      },
      {
        q: "When light passes from air into glass, it bends towards the normal because:",
        opts: ["Speed decreases in denser medium", "Speed increases", "Wavelength increases", "Frequency decreases"],
        ans: 0,
        exp: "Speed decreases in denser medium."
      },
      {
        q: "The bottom of a pool appears shallower than it actually is due to:",
        opts: ["Reflection", "Refraction", "Dispersion", "Diffraction"],
        ans: 1,
        exp: "Light rays bend away from normal at water-air surface."
      },
      {
        q: "Sound cannot travel through vacuum because:",
        opts: ["Vacuum has no temperature", "Sound needs a material medium for propagation", "Light interferes", "Frequency is too high"],
        ans: 1,
        exp: "Sound is a mechanical wave requiring particles."
      },
      {
        q: "Echoes are heard when sound reflects off a hard surface. The minimum distance for an echo (speed 340 m/s, persistence 0.1 s) is approximately:",
        opts: ["17 m", "34 m", "68 m", "100 m"],
        ans: 0,
        exp: "Distance = speed × time / 2 = 340 × 0.1 / 2 = 17 m."
      },
      {
        q: "Loudness of sound depends mainly on:",
        opts: ["Frequency", "Amplitude", "Speed", "Wavelength"],
        ans: 1,
        exp: "Greater amplitude means louder sound."
      },
      {
        q: "Pitch of sound is determined by:",
        opts: ["Amplitude", "Frequency", "Speed", "Medium"],
        ans: 1,
        exp: "Higher frequency → higher pitch."
      },
      {
        q: "Which organelle is found only in plant cells?",
        opts: ["Mitochondria", "Chloroplast", "Ribosome", "Nucleus"],
        ans: 1,
        exp: "Chloroplasts contain chlorophyll for photosynthesis."
      },
      {
        q: "The cell wall in plant cells is primarily made of:",
        opts: ["Cellulose", "Protein", "Chitin", "Lipid"],
        ans: 0,
        exp: "Cellulose provides rigidity."
      },
      {
        q: "Animal cells have prominent vacuoles compared to plant cells.",
        opts: ["True", "False", "Both have equal size", "Animal cells have no vacuoles"],
        ans: 1,
        exp: "Plant cells have large central vacuole; animal cells have small or none."
      },
      {
        q: "The powerhouse of both plant and animal cells is the:",
        opts: ["Nucleus", "Mitochondrion", "Chloroplast", "Golgi body"],
        ans: 1,
        exp: "Mitochondria produce ATP."
      },
      {
        q: "The human skeleton has how many bones in an adult?",
        opts: ["206", "208", "300", "350"],
        ans: 0,
        exp: "Adult human skeleton consists of 206 bones."
      },
      {
        q: "The longest bone in the human body is:",
        opts: ["Humerus", "Tibia", "Femur", "Radius"],
        ans: 2,
        exp: "Femur (thigh bone) is the longest."
      },
      {
        q: "The point where two bones meet is called a:",
        opts: ["Tendon", "Ligament", "Joint", "Cartilage"],
        ans: 2,
        exp: "Joints allow movement."
      },
      {
        q: "Which type of joint is found in the skull?",
        opts: ["Ball and socket", "Hinge", "Pivot", "Fixed (immovable)"],
        ans: 3,
        exp: "Sutures in skull are fixed joints."
      },
      {
        q: "Muscles that work in opposition are called:",
        opts: ["Voluntary muscles", "Involuntary muscles", "Antagonistic pairs", "Cardiac muscles"],
        ans: 2,
        exp: "E.g., biceps and triceps."
      },
      {
        q: "The strongest muscle in the human body relative to its size is:",
        opts: ["Quadriceps", "Masseter (jaw)", "Heart", "Gluteus maximus"],
        ans: 1,
        exp: "Masseter can close jaws with great force."
      },
      {
        q: "Tendons connect:",
        opts: ["Bone to bone", "Muscle to bone", "Muscle to muscle", "Nerve to muscle"],
        ans: 1,
        exp: "Tendons transmit muscle pull to bone."
      },
      {
        q: "Ligaments connect:",
        opts: ["Muscle to bone", "Bone to bone", "Muscle to muscle", "Nerve to bone"],
        ans: 1,
        exp: "Ligaments stabilise joints."
      },
      {
        q: "When ice melts to water at 0°C, the temperature remains constant because heat energy is used to:",
        opts: ["Increase volume", "Break intermolecular bonds (latent heat of fusion)", "Increase particle speed", "Change colour"],
        ans: 1,
        exp: "Latent heat overcomes forces without raising temperature."
      },
      {
        q: "Fractional distillation separates crude oil components based on:",
        opts: ["Density", "Boiling points", "Colour", "Solubility"],
        ans: 1,
        exp: "Lower boiling point fractions vaporise first."
      },
      {
        q: "A solar cooker works mainly by:",
        opts: ["Conduction", "Convection", "Radiation (trapping heat)", "Evaporation"],
        ans: 2,
        exp: "Black surface absorbs radiation; glass traps heat."
      },
      {
        q: "The angle of incidence equals angle of reflection in:",
        opts: ["Refraction", "Regular reflection", "Diffraction", "Dispersion"],
        ans: 1,
        exp: "Law of reflection."
      },
      {
        q: "Sound travels fastest in:",
        opts: ["Air", "Water", "Steel", "Vacuum"],
        ans: 2,
        exp: "Speed highest in solids."
      },
      {
        q: "The human rib cage protects mainly the:",
        opts: ["Brain", "Heart and lungs", "Stomach", "Kidneys"],
        ans: 1,
        exp: "12 pairs of ribs form protective cage."
      },
      {
        q: "Biceps muscle is responsible for:",
        opts: ["Straightening the arm", "Bending the arm", "Rotating the wrist", "Lifting the leg"],
        ans: 1,
        exp: "Biceps contracts to flex elbow."
      }
    ],
    'Basic Technology': [
      {
        q: "To construct a 75° angle using compass and ruler, the most efficient method is to:",
        opts: ["Construct 90° then subtract 15°", "Construct 60° and 90°, then bisect the difference", "Construct 60° then add 15°", "Construct 90° and 60°, then add their bisectors"],
        ans: 1,
        exp: "Construct 60° and 90°. Difference 30°. Bisect 30° to get 15°. Add 60° + 15° = 75°."
      },
      {
        q: "When bisecting an angle with a compass, the correct first step is to:",
        opts: ["Draw an arc crossing both arms", "Place the compass point on the vertex and draw a full circle", "Draw a line from the vertex perpendicular to one arm", "Measure the angle with a protractor"],
        ans: 0,
        exp: "Place compass on vertex, draw arc intersecting both arms."
      },
      {
        q: "To construct a perpendicular bisector of a line segment AB:",
        opts: ["Open compass less than half AB and draw arcs from A only", "Open compass greater than half AB, draw arcs from A and B intersecting at two points, join them", "Use set square directly", "Draw circle with centre midpoint"],
        ans: 1,
        exp: "Arcs from A and B with radius > half AB intersect at two points; line joining them is perpendicular bisector."
      },
      {
        q: "The tool used for cutting external threads on a metal rod is called:",
        opts: ["Tap", "Die", "Reamer", "Scribe"],
        ans: 1,
        exp: "Die cuts external threads; tap cuts internal."
      },
      {
        q: "A try square is primarily used in the workshop to:",
        opts: ["Measure angles", "Check right angles and flatness", "Cut straight lines", "Mark parallel lines"],
        ans: 1,
        exp: "Try square checks 90° edges."
      },
      {
        q: "The correct name of the tool used for smoothening the surface of wood after planing is:",
        opts: ["Jack plane", "Spokeshave", "Rasp", "Sandpaper or glasspaper"],
        ans: 3,
        exp: "Sandpaper removes fine material for smooth finish."
      },
      {
        q: "A hacksaw is used for cutting:",
        opts: ["Wood only", "Metal and plastic", "Paper and cardboard", "Fabric"],
        ans: 1,
        exp: "Hacksaw with fine blade cuts metal."
      },
      {
        q: "In a workshop, wearing safety goggles is most critical when:",
        opts: ["Painting", "Grinding or drilling", "Measuring", "Drawing"],
        ans: 1,
        exp: "Grinding/drilling produces flying particles."
      },
      {
        q: "The correct procedure before using any electrical tool in the workshop is to:",
        opts: ["Switch it on immediately", "Check the power cord for damage and ensure proper earthing", "Oil the moving parts", "Wear gloves"],
        ans: 1,
        exp: "Damaged insulation can cause shock."
      },
      {
        q: "Loose clothing or long hair in a workshop is dangerous because it can:",
        opts: ["Get dirty", "Be caught in rotating machinery", "Reduce visibility", "Cause overheating"],
        ans: 1,
        exp: "Loose items can be pulled into moving parts."
      },
      {
        q: "When carrying sharp tools like chisels in the workshop, you should:",
        opts: ["Point them upwards", "Hold them by the blade", "Point them downwards and away from body", "Keep them in pocket"],
        ans: 2,
        exp: "Points down and away prevents injury."
      },
      {
        q: "To make a simple paper model of a cube (net), how many squares are needed?",
        opts: ["4", "5", "6", "11"],
        ans: 2,
        exp: "A cube net consists of exactly 6 squares."
      },
      {
        q: "In a simple wood project, the joint most suitable for a picture frame corner is:",
        opts: ["Butt joint", "Dovetail joint", "Mitred joint", "Lap joint"],
        ans: 2,
        exp: "Mitred (45°) joint gives neat appearance."
      },
      {
        q: "When making a simple metal key tag by filing, the first step after marking is:",
        opts: ["Drilling holes", "Cutting with hacksaw close to line", "Bending", "Polishing"],
        ans: 1,
        exp: "Rough cut leaves allowance for filing."
      },
      {
        q: "A common simple project using plastic (acrylic) is a:",
        opts: ["Phone stand or ruler", "Hammer handle", "Wooden box", "Metal bracket"],
        ans: 0,
        exp: "Acrylic can be scored, snapped, filed, and polished."
      },
      {
        q: "GPS in smartphones is an example of technology used in daily life for:",
        opts: ["Cooking", "Navigation and location services", "Washing clothes", "Entertainment only"],
        ans: 1,
        exp: "Global Positioning System provides location data."
      },
      {
        q: "Microwave ovens use which type of energy to heat food?",
        opts: ["Infrared", "Ultraviolet", "Microwaves (radio waves)", "Conduction"],
        ans: 2,
        exp: "Microwaves excite water molecules."
      },
      {
        q: "Remote controls for TVs mostly use:",
        opts: ["Bluetooth", "Wi-Fi", "Infrared signals", "Radio waves"],
        ans: 2,
        exp: "IR requires line-of-sight."
      },
      {
        q: "Solar panels in calculators convert light energy directly into:",
        opts: ["Heat energy", "Chemical energy", "Electrical energy", "Mechanical energy"],
        ans: 2,
        exp: "Photovoltaic cells produce electricity."
      },
      {
        q: "Which material is a ferrous metal?",
        opts: ["Aluminium", "Copper", "Mild steel", "Brass"],
        ans: 2,
        exp: "Ferrous metals contain iron."
      },
      {
        q: "Plastics that can be repeatedly softened by heating are called:",
        opts: ["Thermosetting", "Thermoplastic", "Elastomers", "Composites"],
        ans: 1,
        exp: "Thermoplastics soften on heating."
      },
      {
        q: "Wood from deciduous trees (e.g., oak, teak) is classified as:",
        opts: ["Softwood", "Hardwood", "Plywood", "Particle board"],
        ans: 1,
        exp: "Hardwoods from broad-leaved trees."
      },
      {
        q: "The main advantage of aluminium over steel in everyday products is:",
        opts: ["Higher strength", "Lower density and corrosion resistance", "Magnetic property", "Lower cost"],
        ans: 1,
        exp: "Aluminium is lightweight and resists corrosion."
      },
      {
        q: "When making a simple wooden pencil holder (cylindrical), the tool used to bore the central hole is:",
        opts: ["Chisel", "Brace and bit or drill", "Plane", "Saw"],
        ans: 1,
        exp: "Drill bores clean holes."
      },
      {
        q: "In a simple metalwork project to make a tin can lantern, the main process after marking holes is:",
        opts: ["Filing", "Punching with nail and hammer", "Welding", "Threading"],
        ans: 1,
        exp: "Punching creates decorative holes."
      },
      {
        q: "To make a simple paper helicopter that spins when dropped, the critical design feature is:",
        opts: ["Large wings folded in opposite directions", "Heavy weight at bottom only", "No folds", "Square shape"],
        ans: 0,
        exp: "Folded blades create autorotation."
      },
      {
        q: "A simple rubber band-powered boat uses stored:",
        opts: ["Elastic potential energy converted to kinetic", "Chemical energy", "Electrical energy", "Thermal energy"],
        ans: 0,
        exp: "Wound rubber band stores elastic energy."
      },
      {
        q: "The correct way to maintain a handsaw is to:",
        opts: ["Store it in water", "Keep teeth sharp and lightly oiled, store hanging", "Leave it on floor", "Never clean"],
        ans: 1,
        exp: "Sharp teeth cut efficiently; oil prevents rust."
      },
      {
        q: "Files should be cleaned using a:",
        opts: ["File card or wire brush", "Sandpaper", "Water", "Hammer"],
        ans: 0,
        exp: "File card removes metal pins."
      },
      {
        q: "To prevent rust on metal tools, apply a thin layer of:",
        opts: ["Water", "Oil or grease", "Paint only", "Sand"],
        ans: 1,
        exp: "Oil film prevents oxygen and moisture contact."
      },
      {
        q: "A chisel should be sharpened to:",
        opts: ["Rounded edge", "30°–35° bevel angle", "90° angle", "No sharpening needed"],
        ans: 1,
        exp: "Standard wood chisel bevel is about 30°."
      },
      {
        q: "When using a bench vice, the work should be:",
        opts: ["Held loosely", "Clamped firmly but not over-tightened", "Held by hand only", "Placed on floor"],
        ans: 1,
        exp: "Secure hold prevents movement."
      },
      {
        q: "The primary reason for seasoning wood before use in projects is to:",
        opts: ["Make it shiny", "Reduce moisture content and prevent warping/cracking", "Increase weight", "Change colour"],
        ans: 1,
        exp: "Seasoning stabilises wood dimensions."
      },
      {
        q: "In workshop drawing, the line used to represent hidden edges is:",
        opts: ["Continuous thick", "Dashed thin", "Chain line", "Centre line"],
        ans: 1,
        exp: "Dashed lines show hidden edges."
      },
      {
        q: "A centre punch is used before drilling to:",
        opts: ["Enlarge hole", "Create a starting dimple to guide drill bit", "Remove metal", "Mark centre only"],
        ans: 1,
        exp: "Dimple prevents drill wandering."
      },
      {
        q: "Pliers should NOT be used for:",
        opts: ["Gripping small objects", "Turning nuts/bolts (unless adjustable)", "Cutting wire", "Hammering"],
        ans: 3,
        exp: "Using pliers as hammer damages jaws."
      },
      {
        q: "The safest way to carry a hand plane is with the:",
        opts: ["Blade upwards", "Blade downwards and covered", "Blade towards body", "In pocket"],
        ans: 1,
        exp: "Blade down prevents accidental cuts."
      },
      {
        q: "Technology in daily life that uses sensors to detect motion and switch on lights is called:",
        opts: ["Passive infrared (PIR) sensor system", "Bluetooth", "Wi-Fi", "GPS"],
        ans: 0,
        exp: "PIR detects body heat movement."
      },
      {
        q: "The material commonly used for making non-stick cooking pans is coated with:",
        opts: ["Aluminium oxide", "PTFE (Teflon)", "Stainless steel", "Rubber"],
        ans: 1,
        exp: "Polytetrafluoroethylene provides low-friction surface."
      },
      {
        q: "When constructing a 15° angle geometrically, you can:",
        opts: ["Bisect 30°", "Bisect 60° three times", "Use protractor only", "Add 45° and 30°"],
        ans: 0,
        exp: "30° from 60°-90° difference; bisect gives 15°."
      }
    ],
    'Business Studies': [
      {
        q: "The business environment consists of internal and external factors. Which of the following is an example of an external macro-environment factor?",
        opts: ["Company culture", "Employee motivation", "Economic recession", "Management structure"],
        ans: 2,
        exp: "Macro-external factors (PESTLE) include economic conditions."
      },
      {
        q: "A favourable business environment encourages entrepreneurship because it provides:",
        opts: ["High taxes", "Stable political climate and access to markets", "Excessive regulations", "Limited competition"],
        ans: 1,
        exp: "Stability and supportive policies reduce risks."
      },
      {
        q: "The micro-environment of a business includes:",
        opts: ["Global economic trends", "Suppliers, customers, and competitors", "Technological advancements", "Government legislation"],
        ans: 1,
        exp: "Micro-environment involves immediate stakeholders."
      },
      {
        q: "Which factor in the business environment is most likely to affect all businesses in a country simultaneously?",
        opts: ["Competitors' actions", "Change in consumer tastes", "New taxation policy", "Supplier price increase"],
        ans: 2,
        exp: "Macro factors like government policies affect the entire economy."
      },
      {
        q: "The main disadvantage of a sole proprietorship is:",
        opts: ["Limited capital", "Unlimited liability", "Difficulty in decision-making", "High taxation"],
        ans: 1,
        exp: "Owner is personally liable for all debts."
      },
      {
        q: "A sole proprietor enjoys the advantage of:",
        opts: ["Limited liability", "Quick decision-making and full profit retention", "Perpetual existence", "Easy transfer of ownership"],
        ans: 1,
        exp: "Single owner makes fast decisions and keeps all profits."
      },
      {
        q: "In a partnership, the maximum number of partners in a banking business is restricted to:",
        opts: ["10", "20", "50", "No limit"],
        ans: 0,
        exp: "Legal restriction: banking partnerships limited to 10 partners."
      },
      {
        q: "Partnerships are formed through a:",
        opts: ["Memorandum of Association", "Partnership deed/agreement", "Certificate of Incorporation", "Prospectus"],
        ans: 1,
        exp: "Partnership deed outlines rights, duties, profit sharing."
      },
      {
        q: "Human resources in business refer to:",
        opts: ["Machines and equipment", "Employees and their skills", "Raw materials", "Buildings"],
        ans: 1,
        exp: "People who work in the organisation."
      },
      {
        q: "Financial resources are required for:",
        opts: ["Purchasing fixed assets and meeting day-to-day expenses", "Advertising only", "Employee training only", "Record keeping"],
        ans: 0,
        exp: "Capital funds all business operations."
      },
      {
        q: "Material resources include:",
        opts: ["Cash and bank balance", "Raw materials, stock, and tools", "Managerial expertise", "Customer goodwill"],
        ans: 1,
        exp: "Physical inputs needed for production."
      },
      {
        q: "The most important business resource often considered the key to success is:",
        opts: ["Financial", "Human", "Material", "Technological"],
        ans: 1,
        exp: "Skilled, motivated employees drive innovation."
      },
      {
        q: "An open office layout is advantageous because it:",
        opts: ["Provides maximum privacy", "Facilitates supervision and communication", "Reduces space utilisation", "Increases status distinction"],
        ans: 1,
        exp: "Easy oversight and teamwork."
      },
      {
        q: "The main function of an office is to:",
        opts: ["Produce goods", "Provide administrative support and information flow", "Sell products directly", "Store raw materials"],
        ans: 1,
        exp: "Office handles coordination and records."
      },
      {
        q: "A cellular (private) office layout is most suitable for:",
        opts: ["Routine clerical work", "Work requiring concentration and confidentiality", "Large sales teams", "Factory floor"],
        ans: 1,
        exp: "Private rooms reduce distractions."
      },
      {
        q: "Which department in an office is responsible for receiving and dispatching mail?",
        opts: ["Accounts", "Personnel", "Mail/registry", "Sales"],
        ans: 2,
        exp: "Mail room/registry handles correspondence."
      },
      {
        q: "The primary purpose of keeping business records is to:",
        opts: ["Impress customers", "Provide accurate information for decision-making and legal compliance", "Increase paperwork", "Hide transactions"],
        ans: 1,
        exp: "Records track performance and meet statutory requirements."
      },
      {
        q: "A source document for recording cash sales is:",
        opts: ["Invoice", "Receipt issued", "Purchase order", "Delivery note"],
        ans: 1,
        exp: "Duplicate receipt serves as evidence."
      },
      {
        q: "The book used to record small cash payments in an office is called:",
        opts: ["Cash book", "Petty cash book", "Ledger", "Journal"],
        ans: 1,
        exp: "Petty cash book uses imprest system."
      },
      {
        q: "Chronological filing of documents is most suitable for:",
        opts: ["Customer files", "Correspondence by date", "Subject files", "Supplier invoices by amount"],
        ans: 1,
        exp: "Date order easy for sequential correspondence."
      },
      {
        q: "A credit purchase of goods worth $800 should be recorded as:",
        opts: ["Debit Purchases $800, Credit Cash $800", "Debit Purchases $800, Credit Creditor $800", "Debit Creditor $800, Credit Purchases $800", "Debit Cash $800, Credit Purchases $800"],
        ans: 1,
        exp: "Purchases increase (debit), liability increases (credit)."
      },
      {
        q: "If capital at start was $10,000, profit $4,000, drawings $2,000, capital at end is:",
        opts: ["$10,000", "$12,000", "$14,000", "$16,000"],
        ans: 1,
        exp: "Closing capital = Opening + Profit - Drawings = 12,000."
      },
      {
        q: "Cash sales $500, credit sales $300. Total sales recorded in Sales Journal is:",
        opts: ["$500", "$800", "$300", "None"],
        ans: 3,
        exp: "Sales Journal records only credit sales."
      },
      {
        q: "The balancing figure in a Trial Balance represents:",
        opts: ["Profit or loss", "Agreement of debits and credits", "Net assets", "Cash balance"],
        ans: 1,
        exp: "Trial Balance verifies arithmetic accuracy."
      },
      {
        q: "An entrepreneur is primarily characterised by:",
        opts: ["Risk avoidance", "Innovation and risk-taking", "Employment in large firms", "Routine operations"],
        ans: 1,
        exp: "Entrepreneurs identify opportunities and bear risks."
      },
      {
        q: "A key entrepreneurial skill is:",
        opts: ["Following strict rules", "Creativity and problem-solving", "Avoiding competition", "Depending on others"],
        ans: 1,
        exp: "Entrepreneurs think creatively."
      },
      {
        q: "Market research helps an entrepreneur to:",
        opts: ["Avoid customers", "Understand customer needs and competition", "Increase prices", "Reduce production"],
        ans: 1,
        exp: "Research identifies demand and gaps."
      },
      {
        q: "The ability to persevere in the face of setbacks is known as:",
        opts: ["Leadership", "Resilience", "Delegation", "Accounting"],
        ans: 1,
        exp: "Resilience keeps entrepreneurs motivated."
      },
      {
        q: "Business ethics refers to:",
        opts: ["Maximising profit at any cost", "Moral principles guiding business behaviour", "Legal requirements only", "Customer complaints"],
        ans: 1,
        exp: "Ethics involve honesty and fairness."
      },
      {
        q: "Honest advertising is an example of:",
        opts: ["Social responsibility", "Ethical practice", "Profit maximisation", "Tax evasion"],
        ans: 1,
        exp: "Truthful claims build trust."
      },
      {
        q: "Good customer relations involve:",
        opts: ["Ignoring complaints", "Prompt response to queries and complaints", "Overcharging", "Delayed delivery"],
        ans: 1,
        exp: "Courteous service retains customers."
      },
      {
        q: "A business that pollutes the environment without control is ignoring:",
        opts: ["Profit motive", "Social responsibility", "Competition", "Advertising"],
        ans: 1,
        exp: "Ethical businesses consider societal impact."
      },
      {
        q: "The main advantage of a partnership over sole proprietorship is:",
        opts: ["Unlimited liability", "Shared management and more capital", "Difficulty in formation", "Limited life"],
        ans: 1,
        exp: "More partners bring funds and expertise."
      },
      {
        q: "In sole proprietorship, business debts are paid from:",
        opts: ["Business assets only", "Owner's personal assets if needed", "Government funds", "Partners' assets"],
        ans: 1,
        exp: "Unlimited liability means personal assets at risk."
      },
      {
        q: "The office function that deals with staff recruitment and welfare is:",
        opts: ["Accounts", "Personnel/Human Resources", "Sales", "Purchasing"],
        ans: 1,
        exp: "HR manages hiring and employee relations."
      },
      {
        q: "A petty cashier is reimbursed when the petty cash balance falls to:",
        opts: ["Zero", "Imprest amount", "Float level", "Any amount"],
        ans: 2,
        exp: "Imprest system restores to original float."
      },
      {
        q: "Entrepreneurs contribute to society by:",
        opts: ["Creating unemployment", "Providing goods, services, and jobs", "Increasing taxes only", "Reducing competition"],
        ans: 1,
        exp: "Businesses satisfy needs and generate employment."
      },
      {
        q: "Treating customers fairly and respectfully builds:",
        opts: ["Short-term profit", "Customer loyalty and reputation", "Higher prices", "More complaints"],
        ans: 1,
        exp: "Positive relations lead to repeat business."
      },
      {
        q: "A disadvantage of partnership is:",
        opts: ["Limited liability", "Unlimited liability and possible disputes", "Perpetual succession", "Public disclosure"],
        ans: 1,
        exp: "Partners bear unlimited liability; disagreements can arise."
      },
      {
        q: "The document issued to a supplier when goods are returned is:",
        opts: ["Credit note", "Debit note", "Invoice", "Receipt"],
        ans: 0,
        exp: "Credit note reduces amount owed to supplier."
      }
    ]
};
    function render() {
      const app = document.getElementById('app');
if (!user) {
  app.innerHTML = `
    <div class="max-w-md mx-auto mt-20 glass p-10 text-center">
      <div class="text-center mb-12">
        <h1 class="text-6xl font-extrabold bg-gradient-to-r from-pink-400 to-purple-400 bg-clip-text text-transparent mb-4">
          Excellence Tutorial
        </h1>
        <p class="text-2xl opacity-90">Computer-based Testing System</p>
      </div>

      <p class="text-center text-xl mb-8 font-semibold">
       Please login or register to start your exam.
      </p>

      <!-- Login Form -->
      <div id="loginForm">
        <input id="u" class="w-full p-4 rounded-xl mb-4 bg-white/20 text-white placeholder-gray-300" placeholder="Username" autocomplete="off">
        <input id="p" type="password" class="w-full p-4 rounded-xl mb-6 bg-white/20 text-white placeholder-gray-300" placeholder="Password">
        <button onclick="login()" class="btn w-full text-xl mb-4">LOGIN</button>
        <p class="text-sm opacity-80">New student? <span onclick="showRegister()" class="underline cursor-pointer text-pink-300">Register here</span></p>
      </div>

<!-- Registration Form (hidden initially) -->
<div id="registerForm" class="hidden space-y-4">
  <input id="regFirstName" class="w-full p-4 rounded-xl bg-white/20 text-white placeholder-gray-300" placeholder="First Name" required>
  <input id="regLastName" class="w-full p-4 rounded-xl bg-white/20 text-white placeholder-gray-300" placeholder="Last Name" required>
  
  <select id="regClass" class="w-full p-4 rounded-xl bg-white/20 text-white" required>
    <option value="">Select Class</option>
    <optgroup label="Junior Secondary">
      <option value="JSS1">JSS 1</option>
      <option value="JSS2">JSS 2</option>
      <option value="JSS3">JSS 3</option>
    </optgroup>
    <optgroup label="Senior Secondary">
      <option value="SSS1">SSS 1</option>
      <option value="SSS2">SSS 2</option>
      <option value="SSS3">SSS 3</option>
    </optgroup>
  </select>
  
  <input id="regSchool" class="w-full p-4 rounded-xl bg-white/20 text-white placeholder-gray-300" placeholder="School Name" required>
  
  <select id="regFavourite" class="w-full p-4 rounded-xl bg-white/20 text-white" required>
    <option value="">Favourite Subject</option>
    <option>English Language</option>
    <option>General Mathematics</option>
    <option>Physics</option>
    <option>Chemistry</option>
    <option>Basic Science</option>
    <option>Business Study</option>
    <option>Basic Technology</option>
    <option>Biology</option>
    <option>Economics</option>
    <option>Civic Education</option>
    <option>Literature in English</option>
  </select>
  
  <input id="regUsername" class="w-full p-4 rounded-xl bg-white/20 text-white placeholder-gray-300" placeholder="Choose Username" required>
  <input id="regPassword" type="password" class="w-full p-4 rounded-xl bg-white/20 text-white placeholder-gray-300" placeholder="Choose Password" required>
  
  <button onclick="register()" class="btn w-full text-xl">COMPLETE REGISTRATION</button>
  <p class="text-sm opacity-80 text-center">Already have an account? <span onclick="showLogin()" class="underline cursor-pointer text-pink-300">Login here</span></p>
    </div>`;
      }
else if (user === 'Teacher') {
  // Sort attempts by date (newest first)
  const sortedAttempts = [...attempts].sort((a, b) => new Date(b.time) - new Date(a.time));

  // Get list of all registered students
  const registeredStudents = Object.values(students).map(s => ({
    username: Object.keys(students).find(key => students[key] === s),
    ...s
  })).sort((a, b) => a.firstName.localeCompare(b.firstName));

  app.innerHTML = `
    <div class="max-w-6xl mx-auto glass p-8 mt-8 rounded-3xl">
      <div class="flex justify-between items-center mb-8">
        <h1 class="text-4xl font-bold">Teacher Dashboard</h1>
        <button onclick="user=null;render()" class="btn">Logout</button>
      </div>

      <!-- Student Register -->
      <div class="mb-12">
        <h2 class="text-3xl font-bold mb-6">Student Register (${registeredStudents.length} students)</h2>
        <div class="glass-dark p-6 rounded-2xl max-h-96 overflow-y-auto">
          ${registeredStudents.length === 0 ? 
            '<p class="text-center text-xl opacity-70">No registered students yet</p>' :
            '<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">' +
              registeredStudents.map(stu => `
                <div class="bg-white/10 p-4 rounded-xl">
                  <div class="font-semibold">${stu.firstName} ${stu.lastName}</div>
                  <div class="text-sm opacity-80">${stu.class} • ${stu.school}</div>
                  <div class="text-xs opacity-60">Username: ${stu.username}</div>
                </div>
              `).join('') +
            '</div>'
          }
        </div>
      </div>

      <!-- Exam Results -->
      <h2 class="text-3xl font-bold mb-6">Exam Results (${sortedAttempts.length} attempts)</h2>
      <div class="grid gap-6 md:grid-cols-2 lg:grid-cols-3">
        ${sortedAttempts.length === 0 ? 
          '<p class="text-center col-span-3 text-xl opacity-70">No results yet</p>' :
          sortedAttempts.map((a, index) => `
            <div class="glass-dark p-6 rounded-2xl relative">
              <button onclick="deleteResult(${attempts.indexOf(a)})" class="absolute top-4 right-4 text-red-400 hover:text-red-300 text-2xl">×</button>
              <div class="font-bold text-xl">${a.name}</div>
              <div class="text-sm opacity-80">${a.class} • ${new Date(a.time).toLocaleDateString()} ${new Date(a.time).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</div>
              <div class="mt-4">
                ${a.subjects.map(s => `
                  <div class="flex justify-between">
                    <span>${s}:</span>
                    <b>${a.correctAnswers[s] || Math.round(a.scores[s]/100 * 40)}/40 (${a.scores[s]}%)</b>
                  </div>
                `).join('')}
              </div>
              <div class="mt-4 text-center">
                <div class="text-3xl font-bold">${a.totalCorrect}/${a.totalQuestions} correct</div>
                <div class="text-2xl font-bold ${a.grade === 'A' ? 'grade-A' : a.grade === 'B' ? 'grade-B' : a.grade === 'C' ? 'grade-C' : a.grade === 'D' ? 'grade-D' : 'grade-F'} p-3 rounded-xl mt-2">
                  ${a.total}% → Grade ${a.grade}
                </div>
              </div>
            </div>
          `).join('')
        }
      </div>
    </div>`;
}
      else {
        // Student exam flow
        if (!exam) startSubjectSelection();
        else if (exam.step === 'subjects') renderSubjectSelection();
        else if (exam.step === 'exam') renderExam();
        else if (exam.step === 'result') renderResult();
      }
    }

function deleteResult(index) {
  if (confirm("Are you sure you want to delete this result permanently?")) {
    attempts.splice(index, 1);
    localStorage.setItem('excellence_attempts', JSON.stringify(attempts));
    render();  // refresh dashboard
  }
}
function login() {
  const enteredUsername = document.getElementById('u').value.trim();
  const enteredPassword = document.getElementById('p').value.trim();

  const username = enteredUsername.toLowerCase();

  // TEACHER LOGIN - CHECKED FIRST
  if (username === 'teacher' && enteredPassword === 'Master') {
    user = 'Teacher';
    render();
    return;  // STOP HERE — very important
  }

  // STUDENT LOGIN - only if not teacher
  if (students[username] && students[username].password === enteredPassword) {
    user = username;
    render();
    return;
  }

  // Wrong credentials
  alert("Wrong username or password!");
}

    function register() {
  const first = document.getElementById('regFirstName').value.trim();
  const last = document.getElementById('regLastName').value.trim();
  const classLevel = document.getElementById('regClass').value;
  const school = document.getElementById('regSchool').value.trim();
  const favourite = document.getElementById('regFavourite').value;
  const username = document.getElementById('regUsername').value.trim().toLowerCase();
  const password = document.getElementById('regPassword').value.trim();

  if (!first || !last || !classLevel || !school || !favourite || !username || !password) {
    alert("Please fill in all fields!");
    return;
  }

  if (username.length < 4 || password.length < 4) {
    alert("Username and password must be at least 4 characters long.");
    return;
  }

  // Check if username already exists
  if (students[username]) {
    alert("This username is already taken. Please choose another.");
    return;
  }

  // Save student with full details
  students[username] = {
    password: password,
    firstName: first,
    lastName: last,
    class: classLevel,
    school: school,
    favouriteSubject: favourite,
    registeredAt: new Date().toISOString()
  };
  localStorage.setItem('excellence_students', JSON.stringify(students));

  alert(`Registration Successful! 🎉\n\nWelcome, ${first}!\nUsername: ${username}\n\nYou can now login with your username and password.`);
  showLogin();
}
    function showRegister() {
  document.getElementById('loginForm').classList.add('hidden');
  document.getElementById('registerForm').classList.remove('hidden');
}

function showLogin() {
  document.getElementById('registerForm').classList.add('hidden');
  document.getElementById('loginForm').classList.remove('hidden');
}
    function startSubjectSelection() {
      exam = { step: 'subjects', chosen: [] };
      render();
    }

 function renderSubjectSelection() {
  const student = students[user] || { firstName: user, lastName: '', class: 'Unknown', school: 'Excellence Tutorial' };
  const classKey = student.class.toLowerCase().replace(' ', ''); // "JSS1" → "jss1", "SSS 3" → "sss3"

  const availableSubjects = questions[classKey] ? Object.keys(questions[classKey]) : [];

  document.getElementById('app').innerHTML = `
    <div class="max-w-4xl mx-auto glass p-10 mt-10 rounded-3xl text-center">
      <h1 class="text-4xl font-bold mb-8">Welcome, ${student.firstName} ${student.lastName || ''}!</h1>
      <p>Class: ${student.class} • School: ${student.school}</p>
      <p class="text-xl mb-8">Select at least 2 subjects for your exam</p>

      ${availableSubjects.length === 0 ? 
        '<p class="text-red-400 text-2xl">No subjects available for your class yet. Contact teacher.</p>' :
        `<div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8">
          ${availableSubjects.map(s => `
            <label class="glass p-6 rounded-xl cursor-pointer hover:scale-105 transition">
              <input type="checkbox" value="${s}" onchange="toggleSubject(this)"> ${s}
            </label>`).join('')}
        </div>`
      }

      <button onclick="startExam()" id="startBtn" disabled class="btn text-xl px-12">Start Exam</button>
      <button onclick="user=null;exam=null;render()" class="mt-6 text-sm opacity-70">← Logout</button>
    </div>`;
}

    function toggleSubject(cb) {
      if (cb.checked) exam.chosen.push(cb.value);
      else exam.chosen = exam.chosen.filter(x => x !== cb.value);
      document.getElementById('startBtn').disabled = exam.chosen.length < 2;
    }

    function startExam() {
  const student = students[user];
  const classKey = student.class.toLowerCase().replace(' ', '');

  exam = {
    step: 'exam',
    subjects: [...exam.chosen],
    current: 0,
    questionIndex: 0,
    answers: {},
    startTime: Date.now(),
    timeLeft: 40*60,
    classQuestions: questions[classKey]  // save reference
  };
  startTimer();
  renderExam();
}

    function renderExam() {
  const s = exam.subjects[exam.current];
  const q = exam.classQuestions[s][exam.questionIndex];  // ← changed here
      document.getElementById('app').innerHTML = `
        <div class="max-w-4xl mx-auto glass p-8 mt-8 rounded-3xl">
          <div class="flex justify-between items-center mb-8">
            <div>
              <h2 class="text-3xl font-bold">${s}</h2>
              <p>Q${exam.questionIndex+1} of 40 • Overall: ${exam.current*40 + exam.questionIndex + 1} of ${exam.subjects.length*40}</p>
            </div>
            <div class="text-4xl font-bold" id="timer">40:00</div>
          </div>
          <div class="glass-dark p-8 rounded-2xl text-xl">
            <p class="mb-8">${q.q}</p>
            ${q.opts.map((opt,i) => `
              <label class="block p-4 my-2 rounded-xl cursor-pointer hover:bg-white/10 ${exam.answers[`${s}-${exam.questionIndex}`]===i ? 'bg-white/30' : ''}">
                <input type="radio" name="q" value="${i}" onchange="saveAnswer('${s}',${exam.questionIndex},${i})" ${exam.answers[`${s}-${exam.questionIndex}`]===i?'checked':''}>
                ${opt}
              </label>`).join('')}
          </div>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-8">
  <button onclick="prevQuestion()" ${exam.current===0 && exam.questionIndex===0 ? 'disabled' : ''} class="btn md:col-start-1">
    ← Previous
  </button>

  <button onclick="confirmSubmit()" class="btn bg-orange-600 hover:bg-orange-700 md:col-start-2">
    Submit Exam
  </button>

  ${exam.current === exam.subjects.length-1 && exam.questionIndex === 39 ? '' :
    `<button onclick="nextQuestion()" class="btn md:col-start-3">
      Next →
    </button>`
  }
</div>
        </div>`;
      updateTimer();
    }

    function saveAnswer(subject, qIndex, answer) {
      exam.answers[`${subject}-${qIndex}`] = answer;
    }

    function nextQuestion() {
      if (exam.questionIndex < 39) exam.questionIndex++;
      else if (exam.current < exam.subjects.length-1) { exam.current++; exam.questionIndex = 0; }
      renderExam();
    }

    function prevQuestion() {
      if (exam.questionIndex > 0) exam.questionIndex--;
      else if (exam.current > 0) { exam.current--; exam.questionIndex = 39; }
      renderExam();
    }

    function startTimer() {
      timerInterval = setInterval(() => {
        exam.timeLeft--;
        if (exam.timeLeft <= 0) finishExam();
        updateTimer();
      }, 1000);
    }

    function updateTimer() {
      if (!document.getElementById('timer')) return;
      const m = Math.floor(exam.timeLeft/60).toString().padStart(2,'0');
      const s = (exam.timeLeft%60).toString().padStart(2,'0');
      const timerEl = document.getElementById('timer');
      timerEl.textContent = `${m}:${s}`;
      timerEl.className = exam.timeLeft <= 300 ? 'low' : 'text-5xl font-bold';
      if (exam.timeLeft <= 300) document.getElementById('timer').classList.add('text-red-400');
    }

    function confirmSubmit() {
  const answered = Object.keys(exam.answers).length;
  const total = exam.subjects.length * 40;
  const unanswered = total - answered;

  const overlay = document.createElement('div');
  overlay.className = 'fixed inset-0 bg-black/70 flex items-center justify-center z-50 p-4';
  overlay.innerHTML = `
    <div class="glass p-8 rounded-3xl max-w-md w-full text-center">
      <h2 class="text-3xl font-bold mb-6">⚠️ Submit Exam?</h2>
      <p class="text-xl mb-4">You have answered <b>${answered}</b> out of <b>${total}</b> questions.</p>
      ${unanswered > 0 ? `<p class="text-red-400 mb-6"><b>${unanswered}</b> questions are unanswered.</p>` : ''}
      <p class="mb-8">Are you sure you want to submit now?</p>
      <div class="grid grid-cols-2 gap-4">
        <button onclick="this.closest('.fixed').remove()" class="btn bg-gray-600 hover:bg-gray-700">
          Cancel
        </button>
        <button onclick="finishExam(); this.closest('.fixed').remove()" class="btn bg-red-600 hover:bg-red-700">
          Yes, Submit
        </button>
      </div>
    </div>`;
  document.body.appendChild(overlay);
}
    
    function finishExam() {
  clearInterval(timerInterval);

  const scores = {};
  const correctAnswers = {};  // for per-subject correct count
  let totalCorrect = 0;

  exam.subjects.forEach(sub => {
    let correct = 0;
    for (let i = 0; i < 40; i++) {
      const userKey = `${sub}-${i}`;
      if (exam.answers[userKey] === exam.classQuestions[sub][i].ans) {
        correct++;
      }
    }
    scores[sub] = Math.round(correct / 40 * 100);
    correctAnswers[sub] = correct;
    totalCorrect += correct;
  });

  const totalQuestions = exam.subjects.length * 40;
  const percentage = Math.round(totalCorrect / totalQuestions * 100);
  const grade = percentage >= 70 ? 'A' :
                percentage >= 60 ? 'B' :
                percentage >= 50 ? 'C' :
                percentage >= 40 ? 'D' : 'F';

  const studentData = students[user] || {
    firstName: user.charAt(0).toUpperCase() + user.slice(1).toLowerCase(),
    lastName: '',
    class: 'Unknown',
    school: 'Excellence Tutorial'
  };

  const result = {
    name: `${studentData.firstName} ${studentData.lastName}`.trim() || user,
    username: user,
    class: studentData.class,
    school: studentData.school,
    subjects: exam.subjects,
    scores,                    // {subject: percentage}
    correctAnswers,            // {subject: correct count}
    totalQuestions,
    totalCorrect,
    total: percentage,
    grade,
    time: new Date().toISOString()
  };

  attempts.push(result);
  localStorage.setItem('excellence_attempts', JSON.stringify(attempts));

  // Preserve answers and add result for renderResult()
  exam = {
    step: 'result',
    result,
    answers: exam.answers,
    classQuestions: exam.classQuestions  // keep for review/explanations
  };

  renderResult();
}

function shareViaWhatsApp() {
  let message = `Hello Sir,\n\nHere is my attempt result. Thank you.\n\n`;
  message += `Name: ${exam.result.name}\n`;
  message += `Class: ${exam.result.class}\n`;
  message += `Date: ${new Date(exam.result.time).toLocaleDateString()}\n\n`;
  message += `Overall: ${exam.result.total}% (Grade ${exam.result.grade})\n`;
  message += `Total Correct: ${exam.result.totalCorrect}/${exam.result.totalQuestions}\n\n`;
  message += `Subject Scores:\n`;

  exam.result.subjects.forEach(s => {
    const correct = exam.result.correctAnswers[s] || Math.round(exam.result.scores[s]/100 * 40);
    message += `- ${s}: ${correct}/40 (${exam.result.scores[s]}%)\n`;
  });

  message += `\nThank you!`;

  const encodedMessage = encodeURIComponent(message);

  // Your number (international format, no + or spaces)
  const teacherNumber = "2348155095660";

  // Open WhatsApp with pre-filled message
  window.open(`https://wa.me/${teacherNumber}?text=${encodedMessage}`, '_blank');

  alert("WhatsApp opened with your full result! Just tap Send.");
}
    
function renderResult() {
  const r = exam.result;

  // Safe student data
  const student = students[user] || {
    firstName: user.charAt(0).toUpperCase() + user.slice(1).toLowerCase(),
    lastName: '',
    class: 'Unknown Class',
    school: 'Excellence Tutorial'
  };

  // Use the saved classQuestions from exam (preserved in finishExam)
  const classQuestions = exam.classQuestions || {};

  document.getElementById('app').innerHTML = `
    <div class="max-w-6xl mx-auto glass p-10 mt-10 rounded-3xl">
      <div class="text-center mb-12">
        <h1 class="text-6xl font-bold mb-4">Exam Complete!</h1>
        <div class="text-8xl font-bold mb-6 ${r.grade==='A'?'text-green-400':r.grade==='B'?'text-blue-400':r.grade==='C'?'text-yellow-400':r.grade==='D'?'text-orange-400':'text-red-400'}">
          ${r.total}%
        </div>
        <div class="text-5xl font-bold mb-8">Grade: ${r.grade}</div>
        <p class="text-2xl mb-8">
          Great job, ${student.firstName} ${student.lastName}!<br>
          Class: ${student.class} • School: ${student.school}
        </p>
      </div>

      <div class="grid grid-cols-2 gap-4 mt-8">
        <button onclick="shareViaWhatsApp()" class="btn bg-green-600 hover:bg-green-700 text-xl px-12">
          Send Result to Teacher on WhatsApp
        </button>
      </div>

      <!-- Per-subject score summary -->
      <div class="grid grid-cols-2 md:grid-cols-4 gap-6 mb-12">
        ${r.subjects.map(s => {
          const correct = r.correctAnswers[s] || 0;
          return `
            <div class="glass-dark p-6 rounded-2xl text-center">
              <div class="text-lg font-semibold">${s}</div>
              <div class="text-5xl font-bold my-4">${r.scores[s]}%</div>
              <div class="text-sm opacity-80">${correct} / 40 correct</div>
            </div>
          `;
        }).join('')}
      </div>

      <!-- Detailed question review -->
      ${r.subjects.map((subject) => {
        const subjQuestions = classQuestions[subject] || [];
        return `
          <div class="mb-12">
            <h2 class="text-3xl font-bold mb-6 text-center">${subject} — Review</h2>
            <div class="space-y-6">
              ${subjQuestions.map((q, qIdx) => {
                const userKey = `${subject}-${qIdx}`;
                const userAnswer = exam.answers[userKey];
                const isCorrect = userAnswer === q.ans;
                return `
                  <div class="glass-dark p-8 rounded-2xl">
                    <div class="flex justify-between items-start mb-4">
                      <div class="text-xl font-semibold">Q${qIdx + 1}: ${q.q || 'Question not found'}</div>
                      <div class="text-2xl font-bold ${isCorrect ? 'text-green-400' : 'text-red-400'}">
                        ${isCorrect ? '✓ Correct' : '✗ Wrong'}
                      </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                      ${(q.opts || []).map((opt, optIdx) => {
                        const isUser = optIdx === userAnswer;
                        const isCorr = optIdx === q.ans;
                        return `
                          <div class="p-4 rounded-xl ${isCorr ? 'bg-green-500/30 border-2 border-green-400' : isUser && !isCorr ? 'bg-red-500/30 border-2 border-red-400' : 'bg-white/5'}">
                            <span class="font-bold">${String.fromCharCode(65 + optIdx)}.</span> ${opt || ''}
                            ${isCorr ? ' <span class="ml-2 font-bold text-green-300">← Correct Answer</span>' : ''}
                            ${isUser && !isCorr ? ' <span class="ml-2 font-bold text-red-300">← Your Answer</span>' : ''}
                          </div>`;
                      }).join('')}
                    </div>

                    ${!isCorrect ? `
                      <div class="mt-4 p-4 bg-yellow-500/20 rounded-xl border border-yellow-400">
                        <p class="font-semibold text-yellow-300">Explanation:</p>
                        <p>${q.exp || 'No explanation available.'}</p>
                      </div>` : ''
                    }
                  </div>`;
              }).join('')}
            </div>
          </div>`;
      }).join('')}

      <div class="text-center mt-12">
        <p class="text-xl mb-8 text-green-300">✅ Your result has been saved!</p>
        <button onclick="user=null;exam=null;render()" class="btn text-2xl px-16">
          Back to Home
        </button>
      </div>
    </div>`;
}
    render();
  </script>
</body>
</html>
